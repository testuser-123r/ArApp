<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>AR Ball Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- A-Frame Library -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- AR.js Library -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        #score {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: white;
            font-family: Arial, sans-serif;
            z-index: 1;
        }
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            color: red;
            font-family: Arial, sans-serif;
            display: none;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div id="score">Punkte: 0</div>
    <div id="game-over">Spiel Vorbei!<br><button onclick="restartGame()">Neu Starten</button></div>

    <a-scene embedded arjs>
        <!-- Kamera -->
        <a-camera-static></a-camera-static>

        <!-- Hiro Marker -->
        <a-marker type="pattern" url="https://raw.githubusercontent.com/AR-js-org/AR.js/master/three.js/data/data/patt.hiro">
            <!-- Ball -->
            <a-sphere id="ball" position="0 0.5 0" radius="0.1" color="blue"></a-sphere>
        </a-marker>

        <!-- Licht -->
        <a-entity light="type: ambient; color: #BBB"></a-entity>
        <a-entity light="type: directional; intensity: 0.5" position="1 1 0"></a-entity>
    </a-scene>

    <script>
        let score = 0;
        let gameOver = false;
        const scoreElement = document.getElementById('score');
        const gameOverElement = document.getElementById('game-over');
        const ball = document.querySelector('#ball');
        let ballVelocity = -0.02; // Negative Wert, damit der Ball f채llt
        const lowerBound = -1; // Untere Grenze f체r das Spielende

        function updateBall() {
            if (gameOver) return;

            // Aktuelle Position des Balls
            let pos = ball.getAttribute('position');
            pos.y += ballVelocity;
            ball.setAttribute('position', pos);

            // Pr체fen, ob der Ball den unteren Bereich erreicht hat
            if (pos.y < lowerBound) {
                endGame();
                return;
            }

            requestAnimationFrame(updateBall);
        }

        function hitBall() {
            if (gameOver) return;
            ballVelocity = 0.02; // Ball nach oben bewegen
            score += 1;
            scoreElement.innerText = 'Punkte: ' + score;

            // Nach kurzer Zeit wieder fallen lassen
            setTimeout(() => {
                ballVelocity = -0.02;
            }, 200);
        }

        function endGame() {
            gameOver = true;
            gameOverElement.style.display = 'block';
        }

        function restartGame() {
            // Reset Spielstatus
            score = 0;
            scoreElement.innerText = 'Punkte: 0';
            gameOver = false;
            gameOverElement.style.display = 'none';
            ball.setAttribute('position', '0 0.5 0');
            ballVelocity = -0.02;
            updateBall();
        }

        // Event Listener f체r das Schlagen des Balls
        ball.addEventListener('click', hitBall);

        // Start des Spiels
        updateBall();
    </script>
</body>
</html>
